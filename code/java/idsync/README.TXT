Code from the blog post: http://illegalargumentexception.blogspot.co.uk/2008/04/java-synchronizing-on-transient-id.html
